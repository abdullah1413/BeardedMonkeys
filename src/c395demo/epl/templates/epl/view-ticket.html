{% extends 'epl/index.html' %}

{% block content %}

<html>
<head>
	<title>View Ticket Page</title>
</head>
<body>
	<h1>View Ticket Page</h1>
	
    <div class="right">
        <p>
            <a class="button" href="{% url 'manage' %}"><i class="fa fa-chevron-circle-left" aria-hidden="true"></i> Back</a>
            <a class="button" href="edit.asp"><i class="fa fa-pencil" aria-hidden="true"></i> Edit</a>

            <!--check if the user is owner of the ticket. And if he is ownere, he can click resolve button; if not, he can't-->
            {% if user.username == CustID %}
                <a id="myBtn_{{ CallID }}" class="button" href="#">
                    {% if CallStatus == "Open" %}
                        <i class="fa fa-check" aria-hidden="true"></i> Resolved
                    {% else %}
                        <i class="fa fa-check" aria-hidden="true"></i> Re-open
                    {% endif %}
                </a>
            {% else %}
                <a class="button disabled" href="#" style="background-color:grey;">
                    {% if CallStatus == "Open" %}
                        <i class="fa fa-check" aria-hidden="true"></i> Resolved
                    {% else %}
                        <i class="fa fa-check" aria-hidden="true"></i> Re-open
                    {% endif %}
                </a>
            {% endif %}
        </p>
        <p><span style="font-weight:bold;">Posted by</span> {{ CustID }}</p>
    </div>

    <H2><span style="font-weight:bold;">Ticket ID:</span> {{ CallID }}</H2> 
   
    <P><span style="font-weight:bold;">Posted on</span> {{ RecvdDate }} </P>
    <P><span style="font-weight:bold;">Category:</span> {{ Category }} </P>
    <P><span style="font-weight:bold;">Status:</span> <span id="status_{{ CallID }}">{{ CallStatus }}</span></P>
     
    {% if Category == "Hardware" %}
        <p> <span style="font-weight:bold;">What kind of device is having the problem? </span> 
        <br>{{ EquipType }} </p>
        <p> <span style="font-weight:bold;">What is the device's asset ID? </span> 
        <br>{{ AssetTag }} </p>
        <p> <span style="font-weight:bold;">What is the device's name? </span> 
        <br>{{ DeviceName }} </p>
        <p> <span style="font-weight:bold;">What (if any) error message(s) is the device diplaying? </span> 
        <br>{{ ErrorMsg }} </p>
        <p> <span style="font-weight:bold;">What are the specific details of the problem? </span> 
        <br>{{ Description }} </p>
    {% endif %}
    
    {% if Category == "Software" %}
        <p> <span style="font-weight:bold;">Which system?: </span> 
        <br>{{ System }} </p>
        <p> <span style="font-weight:bold;">Is the system completely offline/broken?: </span>
        <br>{{ Offline }} </p>
        <p> <span style="font-weight:bold;">What are the specific details of the problem? </span> 
        <br>{{ Description }} </p>
    {% endif %}
    
    {% if Category == "Service" %}
        <p> <span style="font-weight:bold;">Request type: </span> 
        {{ request_type }} </p>
        <p> <span style="font-weight:bold;">Which system?: </span> 
        {{ System_type }} </p>
        <p> <span style="font-weight:bold;">Asset ID: </span> 
        {{ asset_tag }} </p>
        <p> <span style="font-weight:bold;">Move location: </span> 
        {{ move_location }} </p>
        <p> <span style="font-weight:bold;">Software: </span> 
        {{ software }} </p>
        <p> <span style="font-weight:bold;">PC: </span> 
        {{ pc }} </p>
    {% endif %}
    
    {% if Category == "Password" %}
        <p> <span style="font-weight:bold;">Which system?</span> 
        <br>{{ System_type }} </p>
        <p> <span style="font-weight:bold;">Which account/username?</span> 
        <br>{{ Sys_user }} </p>
    {% endif %}
    
    {% if Category == "Other" %}
        <p> <span style="font-weight:bold;">What is your question/comment?</span> 
        <br>{{ problem }} </p>
    {% endif %}
    
    <p><span style="font-weight:bold;">Further details: </span> 
    <br>
    {{ Description }} </p>

    <div id="myModal" class="modal">
      <!-- Modal content -->
      <div class="modal-content">
          <span class="close">&times;</span>
          <p id="modalText">Are you sure the ticket has been resolved?</p>
          <a class="button modalButton nButton" href="#" style="float:right">No</a> <!-- add class and remove id-->
          <a class="button modalButton" style="visibility:hidden;"></a>
          <a id="yButton" class="button modalButton" href="#" style="float:right; margin-right:20px;">Yes</a>
      </div>
    </div>

</body>
</html>

{% endblock %}
